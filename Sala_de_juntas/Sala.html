<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Agendación de Citas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-calendar-alt"></i> Agendación de Citas</h1>
        </header>
        
        <main>
            <section class="calendar-section">
                <h2><i class="fas fa-calendar"></i> Calendario de Citas</h2>
                <div class="calendar-controls">
                    <button id="prevMonth"><i class="fas fa-chevron-left"></i></button>
                    <h3 id="currentMonthYear">Mes y Año</h3>
                    <button id="nextMonth"><i class="fas fa-chevron-right"></i></button>
                </div>
                <div id="calendar"></div>
            </section>
            
            <section class="form-section">
                <h2>Nueva Cita</h2>
                <form id="citaForm">
                    <div class="form-group">
                        <label for="fecha"><i class="fas fa-calendar-day"></i> Fecha:</label>
                        <input type="date" id="fecha" name="fecha" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="hora"><i class="fas fa-clock"></i> Hora:</label>
                        <input type="time" id="hora" name="hora" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="empresa"><i class="fas fa-building"></i> Empresa:</label>
                        <select id="empresa" name="empresa" required>
                            <option value="">Seleccione una empresa</option>
                            <option value="Empresa A">Empresa A</option>
                            <option value="Empresa B">Empresa B</option>
                            <option value="Empresa C">Empresa C</option>
                            <option value="Otra">Otra</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="otraEmpresaGroup" style="display: none;">
                        <label for="otraEmpresa">Especifique la empresa:</label>
                        <input type="text" id="otraEmpresa" name="otraEmpresa">
                    </div>
                    
                    <div class="form-group">
                        <label for="organizador"><i class="fas fa-user-tie"></i> Organizador:</label>
                        <input type="text" id="organizador" name="organizador" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="descripcion"><i class="fas fa-info-circle"></i> Descripción:</label>
                        <textarea id="descripcion" name="descripcion" rows="3"></textarea>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Guardar Cita</button>
                        <button type="reset" class="btn btn-secondary"><i class="fas fa-undo"></i> Limpiar</button>
                    </div>
                </form>
            </section>
            
            <section class="list-section">
                <h2>Citas Agendadas</h2>
                <div class="filtros">
                    <input type="text" id="buscar" placeholder="Buscar citas...">
                    <select id="filtroEmpresa">
                        <option value="">Todas las empresas</option>
                        <option value="Empresa A">Empresa A</option>
                        <option value="Empresa B">Empresa B</option>
                        <option value="Empresa C">Empresa C</option>
                        <option value="Otra">Otras</option>
                    </select>
                </div>
                <div id="listaCitas"></div>
            </section>
        </main>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
    // Elementos del DOM
    const citaForm = document.getElementById('citaForm');
    const listaCitas = document.getElementById('listaCitas');
    const buscarInput = document.getElementById('buscar');
    const filtroEmpresa = document.getElementById('filtroEmpresa');
    const empresaSelect = document.getElementById('empresa');
    const otraEmpresaGroup = document.getElementById('otraEmpresaGroup');
    const calendarEl = document.getElementById('calendar');
    const currentMonthYearEl = document.getElementById('currentMonthYear');
    const prevMonthBtn = document.getElementById('prevMonth');
    const nextMonthBtn = document.getElementById('nextMonth');
    
    // Array para almacenar las citas
    let citas = JSON.parse(localStorage.getItem('citas')) || [];
    
    // Variables para el calendario
    let currentDate = new Date();
    let currentMonth = currentDate.getMonth();
    let currentYear = currentDate.getFullYear();
    
    // Mostrar/ocultar campo "Otra empresa"
    empresaSelect.addEventListener('change', function() {
        if (this.value === 'Otra') {
            otraEmpresaGroup.style.display = 'block';
            document.getElementById('otraEmpresa').required = true;
        } else {
            otraEmpresaGroup.style.display = 'none';
            document.getElementById('otraEmpresa').required = false;
        }
    });
    
    // Guardar nueva cita
    citaForm.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // Obtener valores del formulario
        const fecha = document.getElementById('fecha').value;
        const hora = document.getElementById('hora').value;
        let empresa = empresaSelect.value;
        const organizador = document.getElementById('organizador').value;
        const descripcion = document.getElementById('descripcion').value;
        
        // Si seleccionó "Otra", usar el valor del campo de texto
        if (empresa === 'Otra') {
            empresa = document.getElementById('otraEmpresa').value;
        }
        
        // Validar que no exista una cita en la misma fecha y hora
        const citaExistente = citas.find(c => c.fecha === fecha && c.hora === hora);
        if (citaExistente) {
            alert('Ya existe una cita agendada para esta fecha y hora.');
            return;
        }
        
        // Crear objeto cita
        const nuevaCita = {
            id: Date.now(),
            fecha,
            hora,
            empresa,
            organizador,
            descripcion,
            fechaCreacion: new Date().toISOString()
        };
        
        // Agregar al array
        citas.push(nuevaCita);
        
        // Guardar en localStorage
        guardarCitas();
        
        // Actualizar lista y calendario
        mostrarCitas();
        generarCalendario();
        
        // Limpiar formulario
        citaForm.reset();
        otraEmpresaGroup.style.display = 'none';
        
        // Mostrar mensaje de éxito
        alert('Cita agendada correctamente!');
    });
    
    // Mostrar citas en la lista
    function mostrarCitas(filtro = '', empresaFiltro = '') {
        listaCitas.innerHTML = '';
        
        // Filtrar citas
        let citasFiltradas = citas.filter(cita => {
            const coincideTexto = 
                cita.empresa.toLowerCase().includes(filtro.toLowerCase()) ||
                cita.organizador.toLowerCase().includes(filtro.toLowerCase()) ||
                cita.descripcion.toLowerCase().includes(filtro.toLowerCase());
            
            const coincideEmpresa = empresaFiltro === '' || cita.empresa === empresaFiltro;
            
            return coincideTexto && coincideEmpresa;
        });
        
        // Ordenar por fecha y hora (más recientes primero)
        citasFiltradas.sort((a, b) => {
            const fechaA = new Date(`${a.fecha}T${a.hora}`);
            const fechaB = new Date(`${b.fecha}T${b.hora}`);
            return fechaA - fechaB;
        });
        
        if (citasFiltradas.length === 0) {
            listaCitas.innerHTML = '<p>No se encontraron citas.</p>';
            return;
        }
        
        citasFiltradas.forEach(cita => {
            const citaElement = document.createElement('div');
            citaElement.className = 'cita';
            citaElement.innerHTML = `
                <h3>${formatearFecha(cita.fecha)} - ${formatearHora(cita.hora)}</h3>
                <p><strong>Empresa:</strong> ${cita.empresa}</p>
                <p><strong>Organizador:</strong> ${cita.organizador}</p>
                ${cita.descripcion ? `<p><strong>Descripción:</strong> ${cita.descripcion}</p>` : ''}
                <div class="acciones">
                    <button class="btn-editar" data-id="${cita.id}"><i class="fas fa-edit"></i> Editar</button>
                    <button class="btn-eliminar" data-id="${cita.id}"><i class="fas fa-trash-alt"></i> Eliminar</button>
                </div>
            `;
            
            listaCitas.appendChild(citaElement);
        });
        
        // Agregar event listeners a los botones
        document.querySelectorAll('.btn-editar').forEach(btn => {
            btn.addEventListener('click', editarCita);
        });
        
        document.querySelectorAll('.btn-eliminar').forEach(btn => {
            btn.addEventListener('click', eliminarCita);
        });
    }
    
    // Formatear fecha para mostrar
    function formatearFecha(fechaStr) {
        const opciones = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        const fecha = new Date(fechaStr);
        return fecha.toLocaleDateString('es-ES', opciones);
    }
    
    // Formatear hora para mostrar
    function formatearHora(horaStr) {
        const [hora, minutos] = horaStr.split(':');
        return `${hora}:${minutos}`;
    }
    
    // Guardar citas en localStorage
    function guardarCitas() {
        localStorage.setItem('citas', JSON.stringify(citas));
    }
    
    // Editar cita
    function editarCita(e) {
        const id = parseInt(e.target.getAttribute('data-id'));
        const cita = citas.find(c => c.id === id);
        
        if (!cita) return;
        
        // Llenar formulario con los datos de la cita
        document.getElementById('fecha').value = cita.fecha;
        document.getElementById('hora').value = cita.hora;
        document.getElementById('organizador').value = cita.organizador;
        document.getElementById('descripcion').value = cita.descripcion || '';
        
        // Manejar el campo de empresa
        const empresasPredefinidas = ['Empresa A', 'Empresa B', 'Empresa C'];
        if (empresasPredefinidas.includes(cita.empresa)) {
            empresaSelect.value = cita.empresa;
            otraEmpresaGroup.style.display = 'none';
        } else {
            empresaSelect.value = 'Otra';
            otraEmpresaGroup.style.display = 'block';
            document.getElementById('otraEmpresa').value = cita.empresa;
        }
        
        // Eliminar la cita original
        citas = citas.filter(c => c.id !== id);
        guardarCitas();
        
        // Actualizar calendario
        generarCalendario();
        
        // Hacer scroll al formulario
        document.querySelector('.form-section').scrollIntoView({ behavior: 'smooth' });
    }
    
    // Eliminar cita
    function eliminarCita(e) {
        if (!confirm('¿Estás seguro de que deseas eliminar esta cita?')) return;
        
        const id = parseInt(e.target.getAttribute('data-id'));
        citas = citas.filter(c => c.id !== id);
        guardarCitas();
        mostrarCitas();
        generarCalendario();
    }
    
    // Filtros
    buscarInput.addEventListener('input', function() {
        mostrarCitas(this.value, filtroEmpresa.value);
    });
    
    filtroEmpresa.addEventListener('change', function() {
        mostrarCitas(buscarInput.value, this.value);
    });
    
    // Generar el calendario
    function generarCalendario() {
        // Obtener primer día del mes y último día del mes
        const firstDay = new Date(currentYear, currentMonth, 1);
        const lastDay = new Date(currentYear, currentMonth + 1, 0);
        
        // Actualizar el título del mes y año
        const monthNames = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio",
                          "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
        currentMonthYearEl.textContent = `${monthNames[currentMonth]} ${currentYear}`;
        
        // Crear encabezados de días de la semana
        const dayNames = ["Dom", "Lun", "Mar", "Mié", "Jue", "Vie", "Sáb"];
        let calendarHTML = '<div class="calendar-header">';
        
        dayNames.forEach(day => {
            calendarHTML += `<div class="calendar-day-name">${day}</div>`;
        });
        
        calendarHTML += '</div><div class="calendar-days">';
        
        // Agregar celdas vacías para días del mes anterior
        for (let i = 0; i < firstDay.getDay(); i++) {
            calendarHTML += '<div class="calendar-day empty"></div>';
        }
        
        // Agregar días del mes
        for (let day = 1; day <= lastDay.getDate(); day++) {
            const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
            const hasCita = citas.some(cita => cita.fecha === dateStr);
            
            // Resaltar días con citas
            const dayClass = hasCita ? 'calendar-day has-appointment' : 'calendar-day';
            
            calendarHTML += `
                <div class="${dayClass}" data-date="${dateStr}">
                    ${day}
                    ${hasCita ? '<div class="appointment-dot"></div>' : ''}
                </div>
            `;
        }
        
        calendarHTML += '</div>';
        calendarEl.innerHTML = calendarHTML;
        
        // Agregar event listeners a los días del calendario
        document.querySelectorAll('.calendar-day:not(.empty)').forEach(dayEl => {
            dayEl.addEventListener('click', function() {
                const date = this.getAttribute('data-date');
                document.getElementById('fecha').value = date;
                
                // Hacer scroll al formulario
                document.querySelector('.form-section').scrollIntoView({ behavior: 'smooth' });
            });
        });
    }
    
    // Cambiar al mes anterior
    prevMonthBtn.addEventListener('click', function() {
        currentMonth--;
        if (currentMonth < 0) {
            currentMonth = 11;
            currentYear--;
        }
        generarCalendario();
    });
    
    // Cambiar al mes siguiente
    nextMonthBtn.addEventListener('click', function() {
        currentMonth++;
        if (currentMonth > 11) {
            currentMonth = 0;
            currentYear++;
        }
        generarCalendario();
    });
    
    // Mostrar citas y calendario al cargar la página
    mostrarCitas();
    generarCalendario();
});
    </script>
    <style>
        /* Estilos generales */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
    background-color: #f5f5f5;
    color: #333;
    line-height: 1.6;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

header {
    text-align: center;
    margin-bottom: 30px;
    padding: 20px 0;
    background-color: #2c3e50;
    color: white;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

header h1 {
    font-size: 2.2rem;
}

header i {
    margin-right: 10px;
}

main {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 30px;
}

section {
    background-color: white;
    padding: 25px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

h2 {
    margin-bottom: 20px;
    color: #2c3e50;
    border-bottom: 2px solid #eee;
    padding-bottom: 10px;
}

/* Formulario */
.form-group {
    margin-bottom: 20px;
}

label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: #34495e;
}

label i {
    margin-right: 8px;
    color: #3498db;
}

input[type="text"],
input[type="date"],
input[type="time"],
select,
textarea {
    width: 100%;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 16px;
    transition: border 0.3s;
}

input[type="text"]:focus,
input[type="date"]:focus,
input[type="time"]:focus,
select:focus,
textarea:focus {
    border-color: #3498db;
    outline: none;
}

textarea {
    resize: vertical;
}

.form-actions {
    display: flex;
    gap: 15px;
    margin-top: 25px;
}

.btn {
    padding: 12px 20px;
    border: none;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.btn i {
    margin-right: 8px;
}

.btn-primary {
    background-color: #3498db;
    color: white;
}

.btn-primary:hover {
    background-color: #2980b9;
}

.btn-secondary {
    background-color: #95a5a6;
    color: white;
}

.btn-secondary:hover {
    background-color: #7f8c8d;
}

/* Lista de citas */
.filtros {
    display: flex;
    gap: 15px;
    margin-bottom: 20px;
}

.filtros input,
.filtros select {
    padding: 10px;
    flex: 1;
}

#listaCitas {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.cita {
    background-color: #f9f9f9;
    padding: 20px;
    border-radius: 6px;
    border-left: 4px solid #3498db;
    transition: transform 0.2s;
}

.cita:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
}

.cita h3 {
    color: #2c3e50;
    margin-bottom: 10px;
}

.cita p {
    margin-bottom: 5px;
    color: #555;
}

.cita .acciones {
    display: flex;
    gap: 10px;
    margin-top: 15px;
}

.cita .acciones button {
    padding: 6px 12px;
    font-size: 14px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.cita .acciones .btn-editar {
    background-color: #f39c12;
    color: white;
}

.cita .acciones .btn-eliminar {
    background-color: #e74c3c;
    color: white;
}

/* Estilos del calendario */
.calendar-section {
    grid-column: span 2;
}

.calendar-controls {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 20px;
    margin-bottom: 15px;
}

.calendar-controls button {
    background: none;
    border: none;
    font-size: 1.2rem;
    cursor: pointer;
    color: #3498db;
    padding: 5px 10px;
    border-radius: 4px;
    transition: background-color 0.2s;
}

.calendar-controls button:hover {
    background-color: #f0f0f0;
}

#currentMonthYear {
    font-size: 1.3rem;
    color: #2c3e50;
    min-width: 200px;
    text-align: center;
}

#calendar {
    background-color: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.calendar-header {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    background-color: #3498db;
    color: white;
    font-weight: bold;
    text-align: center;
}

.calendar-day-name {
    padding: 10px;
    text-transform: uppercase;
    font-size: 0.8rem;
}

.calendar-days {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 1px;
    background-color: #eee;
}

.calendar-day {
    padding: 10px;
    min-height: 60px;
    background-color: white;
    position: relative;
    cursor: pointer;
    transition: all 0.2s;
}

.calendar-day:hover {
    background-color: #f5f5f5;
}

.calendar-day.empty {
    background-color: #f9f9f9;
    cursor: default;
}

.calendar-day.has-appointment {
    background-color: #e8f5e9; /* Fondo verde claro para días con citas */
    font-weight: bold;
}

.appointment-dot {
    position: absolute;
    bottom: 5px;
    left: 50%;
    transform: translateX(-50%);
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background-color: #2e7d32; /* Punto verde oscuro */
}

/* Responsive */
@media (max-width: 768px) {
    main {
        grid-template-columns: 1fr;
    }
    
    .calendar-section {
        grid-column: span 1;
    }
    
    .filtros {
        flex-direction: column;
    }
}
    </style>
</body>
</html>